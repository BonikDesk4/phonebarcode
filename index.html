<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Product Scanner Demo</title>

<!-- QR Scanner Library -->
<script src="https://unpkg.com/html5-qrcode"></script>

<style>
body {
    font-family: Arial, sans-serif;
    background: #f4f6f8;
    margin: 0;
    padding: 15px;
}
h1 { text-align: center; margin-bottom: 10px; }

.scanner-box {
    background: #fff;
    padding: 15px;
    border-radius: 8px;
    box-shadow: 0 3px 8px rgba(0,0,0,0.08);
    margin-bottom: 15px;
}

input {
    width: 100%;
    padding: 14px;
    font-size: 18px;
    border-radius: 6px;
    border: 2px solid #ddd;
}

button {
    width: 100%;
    padding: 12px;
    font-size: 16px;
    background: #4a90e2;
    color: white;
    border: none;
    border-radius: 6px;
    margin-top: 10px;
}

#reader { width: 100%; margin-top: 15px; }

.grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
    gap: 12px;
    margin-top: 15px;
}

.card {
    background: white;
    padding: 12px;
    border-radius: 8px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.08);
}

.price { color: #2e7d32; font-weight: bold; margin-top: 5px; }

.hidden { display: none; }

</style>
</head>
<body>

<h1>Product Scanner Demo</h1>

<div class="scanner-box">
    <input type="text" id="barcodeInput" placeholder="Enter barcode or scan QR code">
    <button onclick="startScanner()">ðŸ“· Scan QR Code</button>
    <div id="reader"></div>
</div>

<div class="grid" id="productGrid">
</div>

<script>
const products = [
  { name: "Rice 5kg", barcode: "1001", qr: "QR1001", price: "à§³450" },
  { name: "Cooking Oil 1L", barcode: "1002", qr: "QR1002", price: "à§³180" },
  { name: "Sugar 1kg", barcode: "1003", qr: "QR1003", price: "à§³120" },
  { name: "Milk Powder", barcode: "1004", qr: "QR1004", price: "à§³550" },
  { name: "Salt 1kg", barcode: "1005", qr: "QR1005", price: "à§³45" },
  { name: "Flour 2kg", barcode: "1006", qr: "QR1006", price: "à§³220" },
  { name: "Tea 250g", barcode: "1007", qr: "QR1007", price: "à§³150" },
  { name: "Coffee 200g", barcode: "1008", qr: "QR1008", price: "à§³300" },
  { name: "Biscuits Pack", barcode: "1009", qr: "QR1009", price: "à§³90" },
  { name: "Chocolates", barcode: "1010", qr: "QR1010", price: "à§³200" },
  { name: "Juice 1L", barcode: "1011", qr: "QR1011", price: "à§³110" },
  { name: "Soft Drink 500ml", barcode: "1012", qr: "QR1012", price: "à§³70" },
  { name: "Noodles Pack", barcode: "1013", qr: "QR1013", price: "à§³60" },
  { name: "Tomato Ketchup", barcode: "1014", qr: "QR1014", price: "à§³130" },
  { name: "Mustard Sauce", barcode: "1015", qr: "QR1015", price: "à§³140" },
  { name: "Soap", barcode: "1016", qr: "QR1016", price: "à§³50" },
  { name: "Shampoo 200ml", barcode: "1017", qr: "QR1017", price: "à§³180" },
  { name: "Toothpaste", barcode: "1018", qr: "QR1018", price: "à§³90" },
  { name: "Detergent 1kg", barcode: "1019", qr: "QR1019", price: "à§³250" },
  { name: "Dishwash Liquid", barcode: "1020", qr: "QR1020", price: "à§³160" }
];

// Generate product grid
const grid = document.getElementById("productGrid");
products.forEach(p => {
    const div = document.createElement("div");
    div.className = "card";
    div.setAttribute("data-barcode", p.barcode);
    div.setAttribute("data-qr", p.qr);
    div.innerHTML = `<strong>${p.name}</strong><div>Barcode: ${p.barcode}</div><div>QR: ${p.qr}</div><div class="price">${p.price}</div>`;
    grid.appendChild(div);
});

let html5QrCode;

function startScanner() {
    const reader = document.getElementById("reader");
    reader.innerHTML = "Starting camera...";

    if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
        alert("Camera not supported on this browser");
        return;
    }

    html5QrCode = new Html5Qrcode("reader");

    html5QrCode.start(
        { facingMode: "environment" },
        { fps: 10, qrbox: { width: 250, height: 250 } },
        qrCodeMessage => {
            document.getElementById("barcodeInput").value = qrCodeMessage;
            filterProducts(qrCodeMessage);
            html5QrCode.stop().then(() => { reader.innerHTML = ""; });
        },
        errorMessage => {}
    ).catch(err => { alert("Camera error: " + err); reader.innerHTML = ""; });
}

// Filter products when typing or scanning
const inputField = document.getElementById("barcodeInput");
inputField.addEventListener("input", () => {
    const code = inputField.value.trim();
    filterProducts(code);
});

function filterProducts(code) {
    document.querySelectorAll(".card").forEach(card => {
        const match = card.getAttribute("data-barcode") === code || card.getAttribute("data-qr") === code || code === "";
        card.style.display = match ? "block" : "none";
    });
}
</script>

</body>
</html>
